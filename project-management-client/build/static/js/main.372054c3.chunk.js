(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{112:function(e,t){},203:function(e,t,a){},212:function(e,t,a){e.exports=a(510)},217:function(e,t,a){},416:function(e,t,a){},448:function(e,t,a){},450:function(e,t,a){},469:function(e,t,a){},482:function(e,t,a){},484:function(e,t,a){},501:function(e,t,a){},503:function(e,t,a){},510:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),s=a(26),o=a.n(s),c=a(95),i=(a(217),a(8)),l=a.n(i),u=a(18),p=a(20),h=a(21),d=a(24),m=a(22),g=a(23),v=a(13),f=a(525),b=a(445),E=a(444),j=a(93),k=a(105),w=a(56),S=a(106),y=a(94),C=a(418),O=a(512),x=a(513),D=a(99),P=a(442),L=a(514),A=a(515),I=a(530),U=a(17),T=a.n(U),N=(a(416),function(e){function t(e){var a;return Object(p.a)(this,t),(a=Object(d.a)(this,Object(m.a)(t).call(this,e))).addProject=function(e){e.preventDefault(),a.props.history.push("/projects/new")},a.handleProjectClick=function(e){e.preventDefault(),a.props.push(e.currentTarget.getAttribute("href"))},a.state={isLoading:!0,projects:[],allProjects:[]},a}return Object(g.a)(t,e),Object(h.a)(t,[{key:"componentDidMount",value:function(){var e=Object(u.a)(l.a.mark(function e(){var t,a;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.props.isAuthenticated){e.next=2;break}return e.abrupt("return");case 2:return e.prev=2,e.next=5,this.props.checkTokens();case 5:if(console.log(this.props.user),t=[],!this.props.user.admin){e.next=11;break}return e.next=10,U.API.get("projects","/projects/all",{headers:{Authorization:"Bearer "+this.props.user.auth.AccessToken}});case 10:t=e.sent;case 11:return e.next=13,U.API.get("projects","/projects",{headers:{Authorization:"Bearer "+this.props.user.auth.AccessToken},queryStringParameters:{username:this.props.user.username}});case 13:a=e.sent,console.log(a),this.setState({projects:a,allProjects:t}),e.next=21;break;case 18:e.prev=18,e.t0=e.catch(2),console.error(e.t0.response);case 21:this.setState({isLoading:!1});case 22:case"end":return e.stop()}},e,this,[[2,18]])}));return function(){return e.apply(this,arguments)}}()},{key:"renderProjectsList",value:function(e){return e.map(function(e){return r.a.createElement(w.LinkContainer,{key:e.projectId,to:"/projects/".concat(e.projectId)},r.a.createElement(C.a,{header:e.title},"Created: "+new Date(e.createdAt).toLocaleString()," ",r.a.createElement("br",null),"Project manager: ",e.projectManager))})}},{key:"renderLander",value:function(){return r.a.createElement("div",{className:"Home"},r.a.createElement("div",{className:"lander"},r.a.createElement("h1",null,"Project Manager"),r.a.createElement("p",null,"A project management app")))}},{key:"renderProjects",value:function(){return r.a.createElement("div",{className:"projects"},r.a.createElement(O.a,null,"Your Projects"),r.a.createElement(x.a,{className:"toolbar"},r.a.createElement(D.a,{onClick:this.addProject},r.a.createElement(P.a,{glyph:"plus"}))),r.a.createElement(L.a,{className:"projects-list"},!this.state.isLoading&&this.renderProjectsList(this.state.projects)))}},{key:"renderAllProjects",value:function(){return r.a.createElement("div",{className:"all-projects"},r.a.createElement(O.a,null,"All Projects"),r.a.createElement(L.a,{className:"projects-list"},!this.state.isLoading&&this.renderProjectsList(this.state.allProjects)))}},{key:"render",value:function(){return r.a.createElement("div",{className:"Home"},this.props.user.admin?r.a.createElement(A.a,{activeKey:this.state.activeKey,onSelect:this.handleSelect,id:"tabs"},r.a.createElement(I.a,{eventKey:1,title:"Your projects"},this.renderProjects()),r.a.createElement(I.a,{eventKey:2,title:"All projects"},this.renderAllProjects())):this.props.isAuthenticated?this.renderProjects():this.renderLander())}}]),t}(n.Component)),M=a(42),B=a(516),R=a(517),V=a(518),F=a(528),H=a(529),z=a(519),K=a(520),_=(a(448),a(107)),Y=(a(450),function(e){var t=e.isLoading,a=e.text,n=e.loadingText,s=(e.className,e.disabled),o=void 0!==s&&s,c=Object(_.a)(e,["isLoading","text","loadingText","className","disabled"]);return r.a.createElement(D.a,Object.assign({className:"LoadingButton $(className)",disabled:o||t},c),t?n:a,t&&r.a.createElement(P.a,{glyph:"refresh",className:"spinning"}))}),q=function(e){function t(e,a){var n;return Object(p.a)(this,t),(n=Object(d.a)(this,Object(m.a)(t).call(this,e,a))).handleChange=function(e){n.setState(Object(M.a)({},e.target.id,e.target.value))},n.handleSubmit=function(){var e=Object(u.a)(l.a.mark(function e(t){var a,r,s;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),n.setState({isLoading:!0}),e.prev=2,e.next=5,U.API.post("projects","/login",{body:{Username:n.state.username,Password:n.state.password}});case 5:return a=e.sent.body,console.log(a),e.next=9,U.API.get("projects","/users",{headers:{Authorization:"Bearer "+a.AccessToken}});case 9:return r=e.sent.body,console.log(r),(s={username:n.state.username,password:n.state.password,attributes:r.UserAttributes,auth:a}).attributes.map(function(e){"custom:admin"===e.Name&&(s.admin=!0)}),s.auth.ClockDrift=Math.floor(new Date/1e3)-s.auth.IssuedAt,localStorage.setItem("ProjectManagerSession",JSON.stringify(s)),n.props.userHasAuthenticated(!0),e.next=18,n.props.setCurrentUser(s);case 18:n.props.history.push("/"),e.next=24;break;case 21:e.prev=21,e.t0=e.catch(2),"User is not confirmed."===e.t0.response.data.body.message?n.setState({isLoading:!1,showConfirm:!0}):"No username/password combination found"===e.t0.message?n.setState({incorrect:!0}):"User does not exist."===e.t0.message?n.props.history.push("/register"):(console.error(e.t0.response),n.setState({isLoading:!1}));case 24:case"end":return e.stop()}},e,this,[[2,21]])}));return function(t){return e.apply(this,arguments)}}(),n.handleDismiss=function(e){n.setState({isConfirmed:!0})},n.handleResend=function(){var e=Object(u.a)(l.a.mark(function e(t){return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.prev=1,e.next=4,U.API.post("projects","register/resend",{Username:n.state.username});case 4:e.next=9;break;case 6:e.prev=6,e.t0=e.catch(1),console.log(e.t0);case 9:case"end":return e.stop()}},e,this,[[1,6]])}));return function(t){return e.apply(this,arguments)}}(),n.handleConfirmSubmit=function(){var e=Object(u.a)(l.a.mark(function e(t){return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),n.setState({isConfirmLoading:!0}),e.prev=2,e.next=5,U.API.post("projects","/register/confirm",{body:{Username:n.state.username,ConfirmationCode:n.state.code}});case 5:alert("Successfully confirmed email! You can now log in."),n.setState({showConfirm:!1,isConfirmLoading:!1}),e.next=13;break;case 9:e.prev=9,e.t0=e.catch(2),console.error(e.t0.response),n.setState({isConfirmLoading:!1});case 13:case"end":return e.stop()}},e,this,[[2,9]])}));return function(t){return e.apply(this,arguments)}}(),n.handleHide=function(e){n.setState({showConfirm:!1})},n.handleChange=n.handleChange.bind(Object(v.a)(Object(v.a)(n))),n.state={isLoading:!1,isConfirmLoading:!1,showConfirm:!1,incorrect:!1,username:"",password:"",code:""},n}return Object(g.a)(t,e),Object(h.a)(t,[{key:"getValidationBoolean",value:function(){var e=this.state.username.length,t=this.state.password.length;return e>0&&t>8}},{key:"getValidationState",value:function(){return this.getValidationBoolean()?"success":"error"}},{key:"render",value:function(){var e=r.a.createElement(B.a,{id:"password-tooltip"},"Password is at least 8 characters long.");return r.a.createElement("div",{className:"Login"},r.a.createElement("form",{onSubmit:this.handleSubmit},r.a.createElement(R.a,{controlId:"username",validationState:this.getValidationState()},r.a.createElement(V.a,null,"Username"),r.a.createElement(F.a,{type:"username",placeholder:"Your username",value:this.state.username,onChange:this.handleChange}),r.a.createElement(F.a.Feedback,null)),r.a.createElement(H.a,{placement:"bottom",overlay:e},r.a.createElement(R.a,{controlId:"password",validationState:this.getValidationState()},r.a.createElement(V.a,null,"Password"),r.a.createElement(F.a,{type:"password",value:this.state.password,onChange:this.handleChange}),r.a.createElement(F.a.Feedback,null))),r.a.createElement(Y,{type:"submit",disabled:!this.getValidationBoolean(),isLoading:this.state.isLoading,text:"Login",loadingText:"Logging in..."}),this.state.showConfirm?r.a.createElement(n.Fragment,null,r.a.createElement(z.a,{className:"alert",bsStyle:"danger",onDismiss:this.handleDismiss},r.a.createElement("h3",null,"Thank you again for registering!"),r.a.createElement("p",null,"Unfortunately you still haven't confirmed your account. Please check your email to find the code to confirm your account before signing in, alternatively, if that doesn't work or you lost the email, click the button below to resend the confirmation email."),r.a.createElement(K.a,{onSubmit:this.handleConfirmSubmit},r.a.createElement(R.a,{controlId:"code"},r.a.createElement(V.a,null,"Code:"),r.a.createElement(F.a,{value:this.state.code,onChange:this.handleChange})),r.a.createElement(Y,{type:"submit",isLoading:this.state.isConfirmLoading,text:"Confirm",loadingText:"Confirming..."})),r.a.createElement("br",null),r.a.createElement("p",null,r.a.createElement(D.a,{onClick:this.handleResend},"Resend email"),r.a.createElement("span",null,"  or  "),r.a.createElement(D.a,{onClick:this.handleDismiss},"Dismiss")))):null))}}]),t}(n.Component),G=a(521),J=a(526),W=(a(469),function(e){function t(e,a){var n;return Object(p.a)(this,t),(n=Object(d.a)(this,Object(m.a)(t).call(this,e,a))).handleSubmit=function(){var e=Object(u.a)(l.a.mark(function e(t){var a;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),n.setState({isLoading:!0}),e.prev=2,a={username:n.state.username,password:n.state.password,email:n.state.email,skills:n.state.skills},e.next=6,U.API.post("projects","/register",{body:{Username:a.username,Password:a.password,Email:a.email,Skills:a.skills}});case 6:n.setState({newUser:a}),n.setState({showConfirm:!0}),e.next=14;break;case 10:e.prev=10,e.t0=e.catch(2),console.error(e.t0.response),n.setState({isLoading:!1});case 14:case"end":return e.stop()}},e,this,[[2,10]])}));return function(t){return e.apply(this,arguments)}}(),n.handleConfirmSubmit=function(){var e=Object(u.a)(l.a.mark(function e(t){return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),n.setState({isConfirmLoading:!0}),console.log(n.state.newUser),e.prev=3,e.next=6,U.API.post("projects","/register/confirm",{body:{Username:n.state.newUser.username,ConfirmationCode:n.state.code}});case 6:alert("Successfully confirmed email! You can now log in."),n.props.history.push("/login"),e.next=14;break;case 10:e.prev=10,e.t0=e.catch(3),console.error(e.t0.response),n.setState({isConfirmLoading:!1});case 14:case"end":return e.stop()}},e,this,[[3,10]])}));return function(t){return e.apply(this,arguments)}}(),n.handleHide=function(e){n.setState({showConfirm:!1})},n.handleChange=n.handleChange.bind(Object(v.a)(Object(v.a)(n))),n.state={isConfirmed:!1,isLoading:!1,isConfirmLoading:!1,showConfirm:!1,email:"",skills:"",username:"",password:"",confirmPass:"",code:"",newUser:{}},n}return Object(g.a)(t,e),Object(h.a)(t,[{key:"getValidationState",value:function(){var e=this.state.email.length,t=this.state.username.length,a=this.state.password.length;return e>0&&t>0&&a>8&&this.state.confirmPass===this.state.password?"success":"error"}},{key:"getValidationBoolean",value:function(){return"success"===this.getValidationState()}},{key:"handleChange",value:function(e){this.setState(Object(M.a)({},e.target.id,e.target.value))}},{key:"render",value:function(){var e=r.a.createElement(B.a,null,"Password must be at least 8 characters long with an upper case, lower case, number and symbol.");return r.a.createElement("div",null,r.a.createElement("form",{onSubmit:this.handleSubmit},r.a.createElement(R.a,{controlId:"email"},r.a.createElement(V.a,null,"Email"),r.a.createElement(F.a,{autoFocus:!0,type:"email",value:this.state.email,onChange:this.handleChange,placeholder:"john.doe@example.com"}),r.a.createElement(F.a.Feedback,null)),r.a.createElement(R.a,{controlId:"username"},r.a.createElement(V.a,null,"Username"),r.a.createElement(F.a,{type:"username",value:this.state.username,onChange:this.handleChange,placeholder:"xXexampleXx"}),r.a.createElement(F.a.Feedback,null)),r.a.createElement(H.a,{placement:"bottom",overlay:e},r.a.createElement(R.a,{controlId:"password",validationState:this.getValidationState()},r.a.createElement(V.a,null,"Password"),r.a.createElement(F.a,{type:"password",value:this.state.password,onChange:this.handleChange}),r.a.createElement(F.a.Feedback,null))),r.a.createElement(R.a,{controlId:"confirmPass",validationState:this.getValidationState()},r.a.createElement(V.a,null,"Confirm password"),r.a.createElement(F.a,{type:"password",value:this.state.confirmPass,onChange:this.handleChange}),r.a.createElement(F.a.Feedback,null),r.a.createElement(G.a,null,"Must match password")),r.a.createElement(R.a,{controlId:"skills"},r.a.createElement(V.a,null,"Skills"),r.a.createElement(F.a,{value:this.state.skills,onChange:this.handleChange}),r.a.createElement(G.a,null,"Enter all your relevant skills, separated by commas")),r.a.createElement(Y,{type:"submit",disabled:!this.getValidationBoolean(),isLoading:this.state.isLoading,text:"Register",loadingText:"Registering..."})),r.a.createElement(J.a,{show:this.state.showConfirm,onHide:this.handleHide},r.a.createElement(K.a,{onSubmit:this.handleConfirmSubmit},r.a.createElement(J.a.Header,null,"Confirm your username."),r.a.createElement(J.a.Body,null,"Please enter the confirmation code sent to your email below:",r.a.createElement(R.a,{controlId:"code"},r.a.createElement(V.a,null,"Code:"),r.a.createElement(F.a,{value:this.state.code,onChange:this.handleChange}))),r.a.createElement(J.a.Footer,null,r.a.createElement(Y,{type:"submit",isLoading:this.state.isConfirmLoading,text:"Confirm",loadingText:"Confirming..."})))))}}]),t}(n.Component)),X=a(522),$=function(e){function t(e){var a;return Object(p.a)(this,t),(a=Object(d.a)(this,Object(m.a)(t).call(this,e))).handleCheckbox=function(e){a.setState({changePassword:!a.state.changePassword})},a.handleChange=function(e){a.setState(Object(M.a)({},e.target.id,e.target.value))},a.handleSubmitEmail=function(){var e=Object(u.a)(l.a.mark(function e(t){return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.handleSubmit(t,!0);case 2:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),a.handleSubmitSkills=function(){var e=Object(u.a)(l.a.mark(function e(t){return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.handleSubmit(t,!1);case 2:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),a.handleSubmit=function(){var e=Object(u.a)(l.a.mark(function e(t,n){var r;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.prev=1,r={headers:{Authorization:"Bearer "+a.props.user.auth.AccessToken},body:{AccessToken:a.props.user.auth.AccessToken,UserAttributes:[{Name:"",Value:""}]}},n?(a.setState({emailLoading:!0}),r.body.UserAttributes.Name="email",r.body.UserAttributes.Value=a.state.email):(a.setState({skillsLoading:!0}),r.body.UserAttributes.Name="custom:skills",r.body.UserAttributes.Value=a.state.email),e.next=6,a.props.checkTokens();case 6:return e.next=8,U.API.put("projects","/users",r);case 8:e.next=14;break;case 10:e.prev=10,e.t0=e.catch(1),a.setState({emailLoading:!1,skillsLoading:!1}),console.error(e.t0.response);case 14:a.setState({emailLoading:!1,skillsLoading:!1});case 15:case"end":return e.stop()}},e,this,[[1,10]])}));return function(t,a){return e.apply(this,arguments)}}(),a.handleSubmitPassword=function(){var e=Object(u.a)(l.a.mark(function e(t){return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),a.setState({isLoading:!0}),e.prev=2,e.next=5,a.props.checkTokens();case 5:return e.next=7,U.Auth.changePassword(a.props.user,a.state.oldPassword,a.state.newPassword);case 7:e.next=12;break;case 9:e.prev=9,e.t0=e.catch(2),console.log(e.t0);case 12:a.setState({isLoading:!1});case 13:case"end":return e.stop()}},e,this,[[2,9]])}));return function(t){return e.apply(this,arguments)}}(),a.state={changePassword:!1,isLoading:!1,emailLoading:!1,skillsLoading:!1,passwordLoading:!1,username:a.props.user.username,email:"",oldPassword:"",newPassword:"",skills:""},a}return Object(g.a)(t,e),Object(h.a)(t,[{key:"componentDidMount",value:function(){var e=Object(u.a)(l.a.mark(function e(){var t=this;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.props.user.attributes.map(function(e){"email"===e.Name&&t.setState({email:e.Value}),"custom:skills"===e.Name&&t.setState({skills:e.Value})});case 1:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"getValidationBoolean",value:function(){var e=this.state.oldPassword.length,t=this.state.newPassword.length;return e>12&&t>12}},{key:"getValidationState",value:function(){return this.getValidationBoolean()?"success":"error"}},{key:"render",value:function(){var e=r.a.createElement(B.a,{id:"usernameTooltip"},"Cannot change username."),t=r.a.createElement(B.a,{id:"passwordTooltip"},"Password must be at least ",r.a.createElement("strong",null,"12 characters"),", contain at least",r.a.createElement("strong",null,"one capital and symbol"),".");return r.a.createElement("div",{className:"Account"},r.a.createElement(L.a,null,r.a.createElement(C.a,null,r.a.createElement(R.a,null,r.a.createElement(V.a,null,"Username:"),r.a.createElement(H.a,{placement:"bottom",overlay:e},r.a.createElement(F.a,{value:this.state.username,disabled:!0})))),r.a.createElement(C.a,null,r.a.createElement(K.a,{inline:!0,onSubmit:this.handleSubmit},r.a.createElement(R.a,{controlId:"email"},r.a.createElement(V.a,null,"Email"),": ",r.a.createElement(F.a,{value:this.state.email,onChange:this.handleChange})),r.a.createElement(Y,{type:"submit",isLoading:this.state.emailLoading,text:"Submit changes",loadingText:"Submitting..."}))),r.a.createElement(C.a,null,r.a.createElement(K.a,{inline:!0,onSubmit:this.handleSubmitSkills},r.a.createElement(R.a,{controlId:"skills"},r.a.createElement(V.a,null,"Skills"),": ",r.a.createElement(F.a,{value:this.state.skills,onChange:this.handleChange})),r.a.createElement(Y,{type:"submit",isLoading:this.state.skillsLoading,text:"Submit changes",loadingText:"Submitting..."}))),r.a.createElement(C.a,null,r.a.createElement(X.a,{onChange:this.handleCheckbox},"Change password"),this.state.changePassword?r.a.createElement(K.a,{inline:!0,onSubmit:this.handleSubmitPassword},r.a.createElement(R.a,{controlId:"oldPassword",validationState:this.getValidationState()},r.a.createElement(V.a,null,"Old password:"),r.a.createElement(H.a,{placement:"bottom",overlay:t},r.a.createElement(F.a,{type:"password",value:this.state.oldPassword,onChange:this.handleChange})),r.a.createElement(F.a.Feedback,null)),r.a.createElement(R.a,{controlId:"newPassword",validationState:this.getValidationState()},r.a.createElement(V.a,null,"New password:"),r.a.createElement(H.a,{placement:"bottom",overlay:t},r.a.createElement(F.a,{type:"password",value:this.state.newPassword,onChange:this.handleChange})),r.a.createElement(F.a.Feedback,null)),r.a.createElement(Y,{type:"submit",disabled:!this.getValidationBoolean,isLoading:this.state.passwordLoading,text:"Change",loadingText:"Changing..."})):null)))}}]),t}(n.Component),Q=function(e){function t(e){var a;return Object(p.a)(this,t),(a=Object(d.a)(this,Object(m.a)(t).call(this,e))).handleSubmit=function(e){e.preventDefault(),a.props.setDevelopers(a.state.currentDevelopers),a.props.confirmDevelopers(!0)},a.state={currentId:0,currentDevelopers:[]},a.addDeveloper=a.addDeveloper.bind(Object(v.a)(Object(v.a)(a))),a.changeDeveloper=a.changeDeveloper.bind(Object(v.a)(Object(v.a)(a))),a.deleteDeveloper=a.deleteDeveloper.bind(Object(v.a)(Object(v.a)(a))),a}return Object(g.a)(t,e),Object(h.a)(t,[{key:"addDeveloper",value:function(e){var t=this.state.currentId,a=this.state.currentDevelopers;a[t]=e,console.log(a),void 0===this.props.developers?this.props.confirmDevelopers(!0):a.length!==this.props.developers.length&&this.props.confirmDevelopers(!1),this.setState({currentId:t+1,currentDevelopers:a})}},{key:"changeDeveloper",value:function(e,t){this.state.currentDevelopers[e]=t}},{key:"deleteDeveloper",value:function(e){var t=this.state.currentDevelopers;t.splice(e,1),0===t.length&&this.props.confirmDevelopers(!0),this.setState({currentId:t.length,currentDevelopers:t})}},{key:"render",value:function(){return r.a.createElement("div",{className:"developers"},r.a.createElement(K.a,{onSubmit:this.handleSubmit},r.a.createElement(Z,{developers:this.state.currentDevelopers,changeDeveloper:this.changeDeveloper,deleteDeveloper:this.deleteDeveloper}),r.a.createElement(ee,{addDeveloper:this.addDeveloper,projectManager:this.props.projectManager,siteUsers:this.props.siteUsers}),r.a.createElement(D.a,{type:"submit",disabled:this.state.confirmDevelopers},"Confirm developers")))}}]),t}(n.Component),Z=function(e){function t(e){var a;return Object(p.a)(this,t),(a=Object(d.a)(this,Object(m.a)(t).call(this,e))).handleChange=function(e){var t=Number(e.target.id),n=e.target.value;a.props.changeDeveloper(t,n)},a.handleDelete=function(e){var t=Number(e.target.id);a.props.deleteDeveloper(t)},a.handleDelete=a.handleDelete.bind(Object(v.a)(Object(v.a)(a))),a}return Object(g.a)(t,e),Object(h.a)(t,[{key:"render",value:function(){var e=this;return this.props.developers.map(function(t,a){return r.a.createElement(C.a,{key:a},r.a.createElement(R.a,{controlId:a.toString()},r.a.createElement(V.a,null,"Developer ",a+1),r.a.createElement(F.a,{onChange:e.handleChange,value:t})),r.a.createElement(D.a,{id:a.toString(),onClick:e.handleDelete},r.a.createElement(P.a,{glyph:"minus"})))})}}]),t}(n.Component),ee=function(e){function t(e){var a;return Object(p.a)(this,t),(a=Object(d.a)(this,Object(m.a)(t).call(this,e))).handleChange=function(e){a.setState({newDeveloper:e.target.value})},a.handleAdd=function(e){a.state.newDeveloper===a.props.projectManager?a.setState({managerError:!0,error:!0}):a.props.siteUsers.includes(a.state.newDeveloper)?a.handleIgnore(e):a.setState({error:!0})},a.handleIgnore=function(e){e.preventDefault(),a.props.addDeveloper(a.state.newDeveloper),a.setState({newDeveloper:"",error:!1})},a.handleClose=function(){a.setState({error:!1})},a.state={newDeveloper:"",managerError:!1,error:!1},a}return Object(g.a)(t,e),Object(h.a)(t,[{key:"validateForm",value:function(){return this.state.newDeveloper.length>0}},{key:"renderModal",value:function(){return r.a.createElement(J.a,{show:this.state.error},r.a.createElement(J.a.Header,null,"Error!"),r.a.createElement(J.a.Body,null,this.state.managerError?r.a.createElement("h4",null,"You cannot add yourself as a developer, this is implied (and can be changed later)."):r.a.createElement("h4",null,"User not found in user base.")),r.a.createElement(J.a.Footer,null,this.state.managerError?null:r.a.createElement(D.a,{onClick:this.handleIgnore},"Add anyway"),r.a.createElement(D.a,{onClick:this.handleClose},"Close")))}},{key:"render",value:function(){return r.a.createElement(C.a,null,r.a.createElement(R.a,{controlId:"newDeveloper"},r.a.createElement(V.a,null,"New developer"),r.a.createElement(F.a,{onChange:this.handleChange,value:this.state.newDeveloper})),r.a.createElement(D.a,{disabled:!this.validateForm(),onClick:this.handleAdd},r.a.createElement(P.a,{glyph:"plus"})),this.renderModal())}}]),t}(n.Component),te=(a(482),function(e){function t(e){var a;return Object(p.a)(this,t),(a=Object(d.a)(this,Object(m.a)(t).call(this,e))).confirmDevelopers=function(e){a.setState({confirmDevelopers:e})},a.handleChange=function(e){a.setState(Object(M.a)({},e.target.id,e.target.value))},a.handleSubmit=function(){var e=Object(u.a)(l.a.mark(function e(t){var n,r,s;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:for(t.preventDefault(),a.setState({isSubmitting:!0}),(n=[]).push(a.props.user.username),r=0;r<a.state.developers.length;r++)n.push(a.state.developers[r]);return e.prev=5,e.next=8,a.props.checkTokens();case 8:return e.next=10,a.createProject({title:a.state.title,projectManager:a.props.user.username,description:a.state.description,developers:a.state.developers,usernames:n});case 10:s=e.sent,console.log(s),a.props.history.push("/"),e.next=19;break;case 15:e.prev=15,e.t0=e.catch(5),console.error(e.t0.response),a.setState({isSubmitting:!1});case 19:case"end":return e.stop()}},e,this,[[5,15]])}));return function(t){return e.apply(this,arguments)}}(),a.state={isLoading:!0,isSubmitting:!1,confirmDevelopers:!0,siteUsers:[],title:"",description:"",developers:[]},a.setDevelopers=a.setDevelopers.bind(Object(v.a)(Object(v.a)(a))),a.confirmDevelopers=a.confirmDevelopers.bind(Object(v.a)(Object(v.a)(a))),a}return Object(g.a)(t,e),Object(h.a)(t,[{key:"componentDidMount",value:function(){var e=Object(u.a)(l.a.mark(function e(){var t,a;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.props.checkTokens();case 3:return e.next=5,U.API.get("projects","/users/list",{headers:{Authorization:"Bearer "+this.props.user.auth.AccessToken}});case 5:t=e.sent,a=[],t.Users.map(function(e){a.push(e.Username)}),this.setState({siteUsers:a}),console.log(this.state.siteUsers),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(0),console.error(e.t0.response);case 15:this.setState({isLoading:!1});case 16:case"end":return e.stop()}},e,this,[[0,12]])}));return function(){return e.apply(this,arguments)}}()},{key:"validateForm",value:function(){return 0!==this.state.title.length&&0!==this.state.description.length&&this.state.confirmDevelopers}},{key:"setDevelopers",value:function(e){this.setState({developers:e})}},{key:"createProject",value:function(e){return U.API.post("projects","/projects",{headers:{Authorization:"Bearer "+this.props.user.auth.AccessToken},body:e})}},{key:"render",value:function(){return r.a.createElement("div",{className:"NewProject"},this.state.isLoading?r.a.createElement("h2",null,"Loading..."):r.a.createElement(L.a,null,r.a.createElement(C.a,null,r.a.createElement(K.a,{onSubmit:this.handleSubmit},r.a.createElement(R.a,{controlId:"title"},r.a.createElement(V.a,null,"Title of project"),": ",r.a.createElement(F.a,{onChange:this.handleChange,value:this.state.title})),r.a.createElement(R.a,{controlId:"description"},r.a.createElement(V.a,null,"Brief description"),": ",r.a.createElement(F.a,{onChange:this.handleChange,value:this.state.description,componentClass:"textarea"})),r.a.createElement(R.a,null,r.a.createElement(Y,{type:"submit",isLoading:this.state.isSubmitting,text:"Create",loadingText:"Creating...",disabled:!this.validateForm()})))),r.a.createElement(C.a,null,r.a.createElement("h4",null,"*OPTIONAL* Add known developers"),r.a.createElement(Q,{setDevelopers:this.setDevelopers,confirmDevelopers:this.confirmDevelopers,name:this.state.title,description:this.state.description,projectManager:this.props.user.username,siteUsers:this.state.siteUsers}))))}}]),t}(n.Component)),ae=a(523),ne=a(527),re=a(524),se=(a(484),function(e){function t(e){var a;Object(p.a)(this,t),(a=Object(d.a)(this,Object(m.a)(t).call(this,e))).changeDeleteBool=function(e){a.setState({confirmDelete:!a.state.confirmDelete})},a.changeManagerBool=function(e){a.setState({confirmManager:!a.state.confirmManager})},a.handleChange=function(e){a.setState(Object(M.a)({},e.target.id,e.target.value))},a.handleSubmit=function(){var e=Object(u.a)(l.a.mark(function e(t){var n;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),a.setState({isLoading:!0}),e.prev=2,e.next=5,a.props.checkTokens();case 5:return e.next=7,U.API.put("projects","/projects/".concat(a.props.project.projectId),{headers:{Authorization:"Bearer "+a.props.user.auth.AccessToken},body:{title:a.state.title,description:a.state.description,projectStatus:a.state.projectStatus}});case 7:n=e.sent,console.log(n),e.next=15;break;case 11:e.prev=11,e.t0=e.catch(2),console.error(e.t0.response),a.setState({isLoading:!1});case 15:a.setState({isLoading:!1});case 16:case"end":return e.stop()}},e,this,[[2,11]])}));return function(t){return e.apply(this,arguments)}}(),a.deleteProject=function(){var e=Object(u.a)(l.a.mark(function e(t){return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),a.setState({isDeleteLoading:!0}),e.prev=2,e.next=5,a.props.checkTokens();case 5:return e.next=7,U.API.del("projects","/projects/".concat(a.props.match.params.id),{headers:{Authorization:"Bearer "+a.props.user.auth.AccessToken}});case 7:e.next=12;break;case 9:e.prev=9,e.t0=e.catch(2),console.error(e.t0.response);case 12:a.setState({isDeleteLoading:!1}),a.props.hist.push("/");case 14:case"end":return e.stop()}},e,this,[[2,9]])}));return function(t){return e.apply(this,arguments)}}(),a.changeDevelopers=function(){var e=Object(u.a)(l.a.mark(function e(t){return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),a.setState({isChangeLoading:!0}),e.prev=2,e.next=5,a.props.checkTokens();case 5:return e.next=7,U.API.put("projects","/projects/".concat(a.props.match.params.id),{headers:{Authorization:"Bearer "+a.props.user.auth.AccessToken},body:{developers:a.state.developers,usernames:a.state.usernames}});case 7:e.next=13;break;case 9:e.prev=9,e.t0=e.catch(2),console.log(e.t0.response),a.setState({isChangeLoading:!1});case 13:case"end":return e.stop()}},e,this,[[2,9]])}));return function(t){return e.apply(this,arguments)}}(),a.state={isLoading:!1,isDeleteLoading:!1,isChangeLoading:!1,confirmDelete:!1,confirmManager:!1,changeManager:!1,projectStatus:a.props.project.projectStatus,title:a.props.project.title,description:a.props.project.description,projectManager:a.props.project.projectManager,developers:a.props.project.developers,usernames:a.props.project.usernames,projectRoles:[{name:"Project Manager",description:"In charge of the project, has complete access."},{name:"Developer",description:"Develops for the project, has access to viewing the project and adding new files/changing ones they've created."}]};var n=[];return n.push({Username:a.props.project.projectManager,Role:"Project Manager"}),a.props.project.developers.map(function(e){n.push({Username:e,Role:"Developer"})}),a.setState({roles:n}),a.setStatus=a.setStatus.bind(Object(v.a)(Object(v.a)(a))),a.setNewRoles=a.setNewRoles.bind(Object(v.a)(Object(v.a)(a))),a.setNewDevelopers=a.setNewDevelopers.bind(Object(v.a)(Object(v.a)(a))),a.changeDevelopers=a.changeDevelopers.bind(Object(v.a)(Object(v.a)(a))),a}return Object(g.a)(t,e),Object(h.a)(t,[{key:"setStatus",value:function(e){this.setState({projectStatus:e})}},{key:"setNewRoles",value:function(e,t){this.setState({changeManager:!0,projectManager:e,developers:t})}},{key:"setNewDevelopers",value:function(e,t){this.setState({developers:e,usernames:t})}},{key:"render",value:function(){return r.a.createElement("div",{className:"ProjectSettings"},r.a.createElement(O.a,null,"Project Settings"),r.a.createElement(L.a,null,r.a.createElement(C.a,null,r.a.createElement("h2",null,"Change project details"),r.a.createElement(K.a,{onSubmit:this.handleSubmit},r.a.createElement(R.a,{controlId:"title"},r.a.createElement(V.a,null,"Title"),": ",r.a.createElement(F.a,{value:this.state.title,placeholder:this.props.project.title,onChange:this.handleChange})),r.a.createElement(R.a,{controlId:"description"},r.a.createElement(V.a,null,"Description"),": ",r.a.createElement(F.a,{value:this.state.description,placeholder:this.props.project.description,onChange:this.handleChange,componentClass:"textarea"})),r.a.createElement(R.a,null,r.a.createElement(ce,{projectStatus:this.state.projectStatus,setStatus:this.setStatus})),r.a.createElement(Y,{type:"submit",isLoading:this.state.isLoading,text:"Change",loadingText:"Changing..."}))),r.a.createElement(C.a,null,r.a.createElement(ae.a,{responsive:!0,striped:!0,bordered:!0},r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",null,"Role"),r.a.createElement("th",null,"Description"))),r.a.createElement("tbody",null,this.state.projectRoles.map(function(e,t){return r.a.createElement("tr",null,r.a.createElement("td",null,e.name),r.a.createElement("td",null,e.description))})))),r.a.createElement(C.a,null,r.a.createElement(ae.a,{responsive:!0,striped:!0,bordered:!0,ref:"Users"},r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",null,"No"),r.a.createElement("th",null,"Username"),r.a.createElement("th",null,"Role"),r.a.createElement("th",null,"Skills"),r.a.createElement("th",null,"Email"),r.a.createElement("th",null))),r.a.createElement("tbody",null,r.a.createElement(oe,{projectManager:this.state.projectManager,developers:this.state.developers,usernames:this.state.usernames,siteUsers:this.props.siteUsers,hist:this.props.hist,match:this.props.match,user:this.props.user,checkTokens:this.props.checkTokens,setNewDevelopers:this.setNewDevelopers,changeDevelopers:this.changeDevelopers})))),r.a.createElement(C.a,null)),r.a.createElement(D.a,{bsStyle:"danger",onClick:this.changeDeleteBool},"Delete Project?"),r.a.createElement(J.a,{className:"delete-prompt",show:this.state.confirmDelete},r.a.createElement(J.a.Header,null,r.a.createElement(J.a.Title,null,"Are you sure?")),r.a.createElement(J.a.Body,null,"Deleting is permanent and you ",r.a.createElement("strong",null,"won't")," be able to get your project back."),r.a.createElement(J.a.Footer,null,r.a.createElement(D.a,{onClick:this.changeDeleteBool},"Cancel"),r.a.createElement(Y,{bsStyle:"danger",onClick:this.deleteProject,isLoading:this.state.isDeleteLoading,text:"Delete",loadingText:"Deleting..."}))))}}]),t}(n.Component)),oe=function(e){function t(e){var a;return Object(p.a)(this,t),(a=Object(d.a)(this,Object(m.a)(t).call(this,e))).handleClick=function(e,t){a.setState({changeManager:!0,newProjectManager:e})},a.handleHide=function(e){a.setState({changeManager:!1,newProjectManager:""})},a.handleRemove=function(){var e=Object(u.a)(l.a.mark(function e(t,n){var r,s;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=a.props.developers,s=a.props.usernames,r.splice(r.indexOf(t),1),s.splice(s.indexOf(t),1),e.next=6,a.props.setNewDevelopers(r,s);case 6:return e.next=8,a.props.changeDevelopers(n);case 8:case"end":return e.stop()}},e,this)}));return function(t,a){return e.apply(this,arguments)}}(),a.handleChange=function(){var e=Object(u.a)(l.a.mark(function e(t){var n;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),a.setState({isChangeLoading:!0}),(n=a.props.developers).splice(n.indexOf(a.state.newProjectManager),1,a.props.projectManager),console.log(n),e.prev=5,e.next=8,a.props.checkTokens();case 8:return e.next=10,U.API.put("projects","/projects/".concat(a.props.match.params.id),{headers:{Authorization:"Bearer "+a.props.user.auth.AccessToken},body:{projectManager:a.state.newProjectManager,developers:n}});case 10:e.next=16;break;case 12:e.prev=12,e.t0=e.catch(5),console.error(e.t0),a.setState({isChangeLoading:!1});case 16:a.props.user.admin?(a.setState({changeManager:!1}),window.location.reload()):a.props.hist.push("/");case 17:case"end":return e.stop()}},e,this,[[5,12]])}));return function(t){return e.apply(this,arguments)}}(),a.state={isLoading:!1,changeManager:!1,newProjectManager:""},a}return Object(g.a)(t,e),Object(h.a)(t,[{key:"renderModal",value:function(){return r.a.createElement(J.a,{className:"change-manager-prompt-"+this.state.newProjectManager,show:this.state.changeManager},r.a.createElement(J.a.Header,null,r.a.createElement(J.a.Title,null,"Are you sure?")),r.a.createElement(J.a.Body,null,"Once you do this you will ",r.a.createElement("strong",null,"not")," be able to change it back (only",r.a.createElement("i",null," "+this.state.newProjectManager)," or an admin can)."),r.a.createElement(J.a.Footer,null,r.a.createElement(D.a,{onClick:this.handleHide},"Cancel"),r.a.createElement(Y,{bsStyle:"danger",onClick:this.handleChange,isLoading:this.state.isLoading,text:"Change",loadingText:"Changing..."})))}},{key:"render",value:function(){var e=this,t=this.props.siteUsers,a=[];return t.map(function(e){a.push(e.Username)}),this.props.usernames.map(function(n,s){var o=n===e.props.projectManager?"Project Manager":"Developer",c="unknown",i="unknown";return a.indexOf(n)>-1&&t[a.indexOf(n)].Attributes.map(function(e){"email"===e.Name&&(c=e.Value),"custom:skills"===e.Name&&(i=e.Value)}),r.a.createElement("tr",null,r.a.createElement("td",null,(s+1).toString()),r.a.createElement("td",null,n),r.a.createElement("td",null,o,"Project Manager"!==o?r.a.createElement(D.a,{onClick:function(t){return e.handleClick(n,t)},style:{float:"right"}},"Make Project Manager"):null),r.a.createElement("td",null,i),r.a.createElement("td",null,c),r.a.createElement("td",null,r.a.createElement(D.a,{onClick:function(t){return e.handleRemove(n,t)}},r.a.createElement(P.a,{glyph:"remove"}))),e.renderModal())})}}]),t}(n.Component),ce=function(e){function t(e){var a;return Object(p.a)(this,t),(a=Object(d.a)(this,Object(m.a)(t).call(this,e))).handleSelect=function(e,t){a.setState({selected:a.state.projectStatuses[e]}),a.props.setStatus(a.state.projectStatuses[e])},a.state={projectStatuses:["pending","active","completed"],selected:a.props.projectStatus},a}return Object(g.a)(t,e),Object(h.a)(t,[{key:"render",value:function(){var e=this;return r.a.createElement(ne.a,{dropup:!0,title:this.state.selected},this.state.projectStatuses.map(function(t,a){return r.a.createElement(re.a,{key:a,eventKey:a,onSelect:e.handleSelect},t)}))}}]),t}(n.Component),ie=(a(203),function(e){function t(e){var a;return Object(p.a)(this,t),(a=Object(d.a)(this,Object(m.a)(t).call(this,e))).state={isLoading:!0,project:a.props.project},a}return Object(g.a)(t,e),Object(h.a)(t,[{key:"renderUsers",value:function(){return this.state.project.developers.map(function(e,t){return r.a.createElement(C.a,{key:t.toString(),header:e})})}},{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement("h1",null,this.state.project.title),r.a.createElement("h2",null,this.state.project.description),r.a.createElement("h3",null,"Project manager: ",this.state.project.projectManager),r.a.createElement(L.a,{className:"developers"},r.a.createElement("h4",null,"Developers:"),this.renderUsers(),r.a.createElement(C.a,null)))}}]),t}(n.Component)),le=function(e){function t(e){var a;return Object(p.a)(this,t),(a=Object(d.a)(this,Object(m.a)(t).call(this,e))).state={isLoading:!0,siteUsers:[],project:{}},a}return Object(g.a)(t,e),Object(h.a)(t,[{key:"componentDidMount",value:function(){var e=Object(u.a)(l.a.mark(function e(){var t,a;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.props.checkTokens();case 3:return e.next=5,this.getProject();case 5:return t=e.sent,e.next=8,U.API.get("projects","/users/list",{headers:{Authorization:"Bearer "+this.props.user.auth.AccessToken}});case 8:a=e.sent,console.log(a.Users),this.setState({isLoading:!1,siteUsers:a.Users,project:t}),e.next=16;break;case 13:e.prev=13,e.t0=e.catch(0),console.log(e.t0.response);case 16:case"end":return e.stop()}},e,this,[[0,13]])}));return function(){return e.apply(this,arguments)}}()},{key:"getProject",value:function(){return U.API.get("projects","/projects/".concat(this.props.match.params.id),{headers:{Authorization:"Bearer "+this.props.user.auth.AccessToken}})}},{key:"renderLoading",value:function(){return r.a.createElement("h1",null,"Loading...")}},{key:"renderProject",value:function(){return r.a.createElement("div",null,this.state.project.projectManager===this.props.user.username||this.props.user.admin?r.a.createElement(A.a,{id:"project-tab"},r.a.createElement(I.a,{eventKey:1,title:"View"},r.a.createElement(ie,{project:this.state.project})),r.a.createElement(I.a,{eventKey:2,title:"Settings"},r.a.createElement(se,{project:this.state.project,hist:this.props.history,match:this.props.match,user:this.props.user,siteUsers:this.state.siteUsers,checkTokens:this.props.checkTokens}))):r.a.createElement(ie,{project:this.state.project}))}},{key:"render",value:function(){return r.a.createElement("div",{className:"Project"},this.state.isLoading?this.renderLoading():this.renderProject())}}]),t}(n.Component),ue=function(e){function t(e){var a;return Object(p.a)(this,t),(a=Object(d.a)(this,Object(m.a)(t).call(this,e))).state={isLoading:!0,siteUsers:[]},a}return Object(g.a)(t,e),Object(h.a)(t,[{key:"componentDidMount",value:function(){var e=Object(u.a)(l.a.mark(function e(){var t;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.props.checkTokens();case 3:return e.next=5,U.API.get("projects","/users/list",{headers:{Authorization:"Bearer "+this.props.user.auth.AccessToken}});case 5:t=e.sent,this.setState({siteUsers:t.Users}),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),console.error(e.t0.response);case 12:this.setState({isLoading:!1});case 13:case"end":return e.stop()}},e,this,[[0,9]])}));return function(){return e.apply(this,arguments)}}()},{key:"renderUserList",value:function(e){return e.map(function(e){return r.a.createElement(C.a,{key:e.Username,header:e.Username},e.Attributes.map(function(e){return"email"===e.Name?r.a.createElement("p",null,"Email: ",e.Value):"custom:skills"===e.Name?r.a.createElement("p",null,"Skills: ",e.Value):void 0}),r.a.createElement("p",null,"Created at: ",new Date(e.UserCreateDate).toLocaleString()))})}},{key:"render",value:function(){return r.a.createElement("div",{className:"Users"},r.a.createElement(O.a,null,"Current Users"),r.a.createElement(L.a,{className:"users-list"},!this.state.isLoading&&this.state.siteUsers&&this.renderUserList(this.state.siteUsers)))}}]),t}(n.Component),pe=(a(501),function(){return r.a.createElement("div",{className:"NotFound"},r.a.createElement("h3",null,"Sorry, this page does not exist."))}),he=function(e){var t=e.component,a=e.props,n=Object(_.a)(e,["component","props"]);return r.a.createElement(y.a,Object.assign({},n,{render:function(e){return r.a.createElement(t,Object.assign({},e,a))}}))},de=function(e){var t=e.childProps;return r.a.createElement(S.a,null,r.a.createElement(he,{path:"/",exact:!0,component:N,props:t}),r.a.createElement(he,{path:"/login",exact:!0,component:q,props:t}),r.a.createElement(he,{path:"/register",exact:!0,component:W,props:t}),r.a.createElement(he,{path:"/account",exact:!0,component:$,props:t}),r.a.createElement(he,{path:"/projects/new",exact:!0,component:te,props:t}),r.a.createElement(he,{path:"/projects/:id",exact:!0,component:le,props:t}),r.a.createElement(he,{path:"/users",exact:!0,component:ue,props:t}),r.a.createElement(y.a,{component:pe}))},me=(a(503),function(e){function t(e){var a;return Object(p.a)(this,t),(a=Object(d.a)(this,Object(m.a)(t).call(this,e))).userHasAuthenticated=function(e){a.setState({isAuthenticated:e})},a.setCurrentUser=function(e){a.setState({user:e})},a.handleLogout=function(){var e=Object(u.a)(l.a.mark(function e(t){return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.prev=1,e.next=4,a.checkTokens();case 4:return e.next=6,U.API.post("projects","/logout",{headers:{Authorization:"Bearer "+a.state.user.auth.AccessToken}});case 6:localStorage.removeItem("ProjectManagerSession"),a.userHasAuthenticated(!1),a.setCurrentUser({}),a.props.history.push("/"),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(1),console.error(e.t0.response);case 15:case"end":return e.stop()}},e,this,[[1,12]])}));return function(t){return e.apply(this,arguments)}}(),a.state={isAuthenticated:!1,isAuthenticating:!0,user:null},a.setCurrentUser=a.setCurrentUser.bind(Object(v.a)(Object(v.a)(a))),a.checkTokens=a.checkTokens.bind(Object(v.a)(Object(v.a)(a))),a}return Object(g.a)(t,e),Object(h.a)(t,[{key:"componentDidMount",value:function(){var e=Object(u.a)(l.a.mark(function e(){var t;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,t=JSON.parse(localStorage.getItem("ProjectManagerSession")),console.log(t),null!==t){e.next=8;break}return console.log("User is null"),this.userHasAuthenticated(!1),this.setState({isAuthenticating:!1}),e.abrupt("return");case 8:return this.setCurrentUser(t),console.log(this.state.user),e.next=12,this.setState({user:t});case 12:return e.next=14,this.checkTokens();case 14:this.userHasAuthenticated(!0),e.next=20;break;case 17:e.prev=17,e.t0=e.catch(0),console.error(e.t0);case 20:this.setState({isAuthenticating:!1});case 21:case"end":return e.stop()}},e,this,[[0,17]])}));return function(){return e.apply(this,arguments)}}()},{key:"checkTokens",value:function(){var e=Object(u.a)(l.a.mark(function e(){var t,a;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log("called check tokens"),!(Math.floor(new Date/1e3)-this.state.user.auth.ClockDrift>this.state.user.auth.Expiration)){e.next=22;break}return e.prev=3,t=this.state.user,e.next=7,U.API.get("projects","/users/refresh",{queryStringParameters:{RefreshToken:t.auth.RefreshToken}});case 7:return a=e.sent.body,console.log(a),t.auth.AccessToken=a.AccessToken,t.auth.IdToken=a.IdToken,t.auth.IssuedAt=a.IssuedAt,t.auth.Expiration=a.Expiration,t.auth.ClockDrift=Math.floor(new Date/1e3)-a.IssuedAt,console.log("Refreshed Access and Id tokens"),e.next=17,this.setState(t);case 17:e.next=22;break;case 19:e.prev=19,e.t0=e.catch(3),console.log(e.t0.response);case 22:return e.abrupt("return");case 23:case"end":return e.stop()}},e,this,[[3,19]])}));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e={isAuthenticated:this.state.isAuthenticated,user:this.state.user,setCurrentUser:this.setCurrentUser,userHasAuthenticated:this.userHasAuthenticated,checkTokens:this.checkTokens};return!this.state.isAuthenticating&&r.a.createElement("div",{className:"App"},r.a.createElement(f.a,{fluid:!0,collapseOnSelect:!0},r.a.createElement(f.a.Header,null,r.a.createElement(f.a.Brand,null,r.a.createElement(j.a,{to:"/"},r.a.createElement("h2",null,"Project Manager"))),r.a.createElement(f.a.Toggle,null)),r.a.createElement(f.a.Collapse,null,r.a.createElement(b.a,{pullRight:!0},this.state.isAuthenticated?r.a.createElement(n.Fragment,null,r.a.createElement(w.LinkContainer,{to:"/users"},r.a.createElement(E.a,null,"Users")),r.a.createElement(w.LinkContainer,{to:"/account"},r.a.createElement(E.a,null,this.state.user.username)),r.a.createElement(E.a,{onClick:this.handleLogout},"Logout")):r.a.createElement(n.Fragment,null,r.a.createElement(w.LinkContainer,{to:"/login"},r.a.createElement(E.a,null,"Login")),r.a.createElement(w.LinkContainer,{to:"/register"},r.a.createElement(E.a,null,"Register")))))),r.a.createElement(de,{childProps:e}))}}]),t}(n.Component)),ge=Object(k.a)(me);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var ve={REGION:"eu-west-2",BUCKET:"project-management-projects"},fe={REGION:"eu-west-2",URL:"https://z8ogont2v6.execute-api.eu-west-2.amazonaws.com/dev"},be={REGION:"eu-west-2",USER_POOL_ID:"eu-west-2_7DRbUQOk6",APP_CLIENT_ID:"27cus2iiajkktqa6tk984jqgqa",IDENTITY_POOL_ID:"eu-west-2:16e65f15-a1f6-4c57-b896-108cdd4593b6"};T.a.configure({Storage:{region:ve.REGION,bucket:ve.BUCKET,identityPoolId:be.IDENTITY_POOL_ID},API:{endpoints:[{name:"projects",region:fe.REGION,endpoint:fe.URL}]}}),o.a.render(r.a.createElement(c.a,null,r.a.createElement(ge,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[212,2,1]]]);
//# sourceMappingURL=main.372054c3.chunk.js.map